import Bugsnag from '@bugsnag/js';
import { parse } from 'toml';
const { default: { notify }, } = Bugsnag;
/** Gracefully parses a toml file and reports errors to bugsnag */
function gracefulParseToml(content) {
    try {
        return parse(content);
    }
    catch (error) {
        notify(error, (event) => {
            event.context = '@netlify/build-info => gracefullyParseToml => toml.parse';
            event.severity = 'info';
        });
        return {};
    }
}
export async function getNetlifyTomlSettings(fs, directory) {
    const tomlFilePath = fs.join(directory, 'netlify.toml');
    try {
        const settings = {};
        const { build, functions, template } = gracefulParseToml(await fs.readFile(tomlFilePath));
        if (build) {
            settings.cmd = build?.command;
            settings.dir = build.publish;
        }
        settings.functions_dir = build?.functions || functions?.directory;
        settings.template = template;
    }
    catch {
        // no toml found
        return {};
    }
}
//# sourceMappingURL=get-toml-settings.js.map